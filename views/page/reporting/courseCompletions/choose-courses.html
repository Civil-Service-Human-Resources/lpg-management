{% from "../../../component/reporting/macro.njk" import reporting with context %}
{% from "radios/macro.njk" import govukRadios %}
{% from "select/macro.njk" import govukSelect %}
{% from "button/macro.njk" import govukButton %}
{% from "checkboxes/macro.njk" import govukCheckboxes %}
{% from "error-summary/macro.njk" import govukErrorSummary %}

{% extends "../../../component/Page.njk" %}

{% block pageTitle %}{{ i18n.reporting.course_completions.title }} - {{ i18n.proposition_name }}{% endblock %}
{% block content %}
    {% set errors = sessionFlash.errors %}
    {{ errorSummary(errors.fields, true) }}
<div class="govuk-grid-row">
  <div class="govuk-grid-column-two-thirds">
    <span class="govuk-caption-m">Reporting</span>
    <h1 class="govuk-heading-l">{{ i18n.reporting.course_completions.title }}</h1>
    <form method="post" action="/reporting/course-completions/choose-courses">
        {% set requiredLearningOptions = pageModel.requiredLearningList %}
        {% set requiredLearningOptions = requiredLearningOptions.concat({
            "divider": "or"
        }) %}
        {% set requiredLearningOptions = requiredLearningOptions.concat({
            "value": "all",
            "text": "All required learning",
            "behaviour": "exclusive"
        }) %}
        <input type='hidden' name='allRequiredLearning' value='{{ pageModel.allRequiredLearning }}'>
      {% set requiredHtml %}
        {{ govukCheckboxes({
          name: "requiredLearning",
          classes: "govuk-checkboxes--small",
          fieldset: {
            legend: {
              text: "Required learning"
            }
          },
          items: requiredLearningOptions
        }) }}
      {% endset -%}
      {{ govukRadios({
        name: "learning",
        fieldset: {
          legend: {
            text: "What courses would you like to report on?",
            classes: "govuk-fieldset__legend--s"
          }
        },
        items: [
          {
            value: "requiredLearning",
            text: "Required learning for " + pageModel.userDepartment,
            conditional: {
            html: requiredHtml
          },
            checked: true
          }
        ]
      }) }}
      {{ govukButton({
        text: "Continue"
      }) }}
    </form>
  </div>
</div>
{% endblock %}

{% block bodyEnd %}
    <script src="/govuk-frontend/all.js"></script>
    <script>window.GOVUKFrontend.initAll()</script>
    <script type="text/javascript" src="/js/accessible-autocomplete.min.js"></script>
    <script type="text/javascript" src="/js/manage-orgs.js"></script>
{% endblock %}
